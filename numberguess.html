<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŒœæ•°å­—æŒ‘æˆ˜èµ›</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; background: #f4f4f9; padding: 20px; }
        .container { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        h1 { color: #333; font-size: 1.5rem; }
        .stats { margin-bottom: 1rem; color: #666; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-size: 1.2rem; letter-spacing: 2px; text-align: center; }
        button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; }
        button:hover { background: #0056b3; }
        .history { margin-top: 20px; width: 100%; max-height: 200px; overflow-y: auto; border-top: 1px solid #eee; padding-top: 10px; }
        .log-item { font-size: 0.9rem; padding: 5px; border-bottom: 1px solid #f9f9f9; }
        .success { color: #28a745; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>çŒœæ•°å­—æŒ‘æˆ˜</h1>
    <div class="stats" id="info">å½“å‰æ•°å­—é•¿åº¦: <span id="current-len">1</span></div>
    
    <input type="text" id="guessInput" placeholder="è¾“å…¥æ•°å­—..." autocomplete="off">
    <button onclick="checkGuess()">æäº¤çŒœæƒ³</button>

    <div id="message" style="margin-top: 15px; min-height: 24px;"></div>

    <div class="history" id="historyLog">
        <strong>å°è¯•è®°å½•ï¼š</strong>
    </div>
</div>

<script>
    let currentLength = 1;
    let answer = "";
    let attempts = 0;

    // åˆå§‹åŒ–æ¸¸æˆ
    function initGame() {
        attempts = 0;
        answer = "";
        // ç”Ÿæˆç¬¬ä¸€ä¸ªæ•°å­—ä¸ä¸º0çš„éšæœºæ•°ï¼ˆæ¨¡æ‹ŸåŸPythoné€»è¾‘ï¼‰
        answer += Math.floor(Math.random() * 9 + 1).toString();
        for (let i = 1; i < currentLength; i++) {
            answer += Math.floor(Math.random() * 10).toString();
        }
        document.getElementById('current-len').innerText = currentLength;
        document.getElementById('historyLog').innerHTML = "<strong>å°è¯•è®°å½•ï¼š</strong>";
        document.getElementById('message').innerText = "æ¸¸æˆå¼€å§‹ï¼è¯·è¾“å…¥ " + currentLength + " ä½æ•°å­—";
        console.log("ç­”æ¡ˆ(è°ƒè¯•ç”¨):", answer); // å®é™…ä¸Šçº¿å¯ä»¥åˆ æ‰è¿™è¡Œ
    }

    function checkGuess() {
        const guess = document.getElementById('guessInput').value;
        const msgZone = document.getElementById('message');
        
        if (guess.length !== currentLength || isNaN(guess)) {
            msgZone.innerText = "è¯·è¾“å…¥é•¿åº¦ä¸º " + currentLength + " çš„çº¯æ•°å­—ï¼";
            msgZone.style.color = "red";
            return;
        }

        attempts++;
        let correct = 0; // A: ä½ç½®å’Œæ•°å­—éƒ½å¯¹
        let wrongPos = 0; // B: æ•°å­—å¯¹ä½†ä½ç½®ä¸å¯¹

        // ç»Ÿè®¡é¢‘ç‡çš„é€»è¾‘ï¼ˆå¯¹åº”åŸPythonä¸­çš„arranså’Œarrcorrï¼‰
        let ansCount = Array(10).fill(0);
        let guessCount = Array(10).fill(0);
        let matchedInPos = Array(10).fill(0);

        for (let i = 0; i < currentLength; i++) {
            let a = parseInt(answer[i]);
            let g = parseInt(guess[i]);
            ansCount[a]++;
            if (a === g) {
                correct++;
                matchedInPos[a]++;
            } else {
                guessCount[g]++;
            }
        }

        for (let i = 0; i < 10; i++) {
            // å‰©ä½™å¯åŒ¹é…çš„æ•°é‡
            let remainingAns = ansCount[i] - matchedInPos[i];
            wrongPos += Math.min(guessCount[i], remainingAns);
        }

        // è¾“å‡ºç»“æœ
        const resultText = `çŒœ ${guess}: âœ…${correct}ä½æ­£ç¡®, âš ï¸${wrongPos}ä½ä½ç½®é”™è¯¯ (ç¬¬${attempts}æ¬¡)`;
        const logItem = document.createElement('div');
        logItem.className = 'log-item';
        logItem.innerText = resultText;
        document.getElementById('historyLog').prepend(logItem);

        if (correct === currentLength) {
            msgZone.innerText = "ğŸ‰ æ­å–œï¼é•¿åº¦ " + currentLength + " å·²ç ´è¯‘ï¼";
            msgZone.style.color = "green";
            currentLength++; // è‡ªåŠ¨å¢åŠ éš¾åº¦
            setTimeout(initGame, 2000); // 2ç§’åå¼€å§‹ä¸‹ä¸€å…³
        } else {
            msgZone.innerText = "ç»§ç»­åŠªåŠ›ï¼";
            msgZone.style.color = "#333";
        }
        
        document.getElementById('guessInput').value = "";
        document.getElementById('guessInput').focus();
    }

    // å›è½¦æäº¤
    document.getElementById('guessInput').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') checkGuess();
    });

    initGame();
</script>

</body>
</html>